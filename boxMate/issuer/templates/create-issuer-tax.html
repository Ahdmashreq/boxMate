{% extends 'main.html'%}
{% load static %}

{% block body %}
<div class="content-wrapper">
   <!-- Content Header (Page header) -->
   <section class="content-header">
      <h1>
         Add  Taxs
         <!-- <small>Optional description</small> -->
      </h1>

   </section>
   <!-- Main content -->
   <section class="content">
            <div class="box">
               <!-- /.box-header -->
               <div class="container-fluid">
               <table class="table table-striped table-bordered" id="dataTable"  width="100%">
                <tr>
                                            <th scope="col">Code</th>
                                            <th scope="col">Description</th>
                                            <th scope="col">Check to use</th>
                                          </tr>
                                        </thead>
                                    <tbody>
                                        {% for sub_tax in sub_taxs %}
                                      <tr>
                                        <td>{{sub_tax.code}}</td>
                                        <td>{{sub_tax.desc_en}}</td>
                                        <td>
                                            <input type="checkbox" onclick="myFunction({{sub_tax}})" type="checkbox"  name="checkbox" id="checkbox">
                                            &nbsp; 
                                            <label for="checkbox"  id="{{sub_tax}}" style="display: none;">{{sub_tax.code}}</label>
                                            <br>
                                            {% endfor %}
                                        </td>
                                      </tr>
                                    </tbody>
                                </table>

                              <br>
                           <button type="submit"  onclick="myFunction2()" class="btn btn-primary">Save</button>

     
</div>
</div>
</section>
</div>

<script>
  var codes_arr =[]
  console.log ( Array.isArray(codes_arr))
  var issuer = {{issuer_id}}

  function myFunction(sub_tax)
   {
    codes_arr  
    issuer = {{issuer_id}}
    code = sub_tax.innerHTML
    if(codes_arr.includes(code))
    {codes_arr.pop(code)}
    else{codes_arr.push(code)}

    console.log(codes_arr)
    console.log(issuer)

    return codes_arr
   }
  function myFunction2(){
    codes_arr 
    issuer = {{issuer_id}}
    console.log(issuer)
    
  $.ajax({
            url: '/issuer/create/issuer/tax',
            data : {
                'issuer' :issuer,
                'codes_arr' : codes_arr

            },
            dataType : 'json',
            success: function(data){
                    alert(data.error_message);
                
            }
  
        });
      }

</script>


{% endblock body %}
